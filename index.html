<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lebensalm wichtelt</title>
<link href="https://fonts.googleapis.com/css2?family=Tangerine:wght@700&display=swap" rel="stylesheet">
<style>
  :root {
    --christmas-red: #E53935;
    --christmas-green: #4CAF50;
    --christmas-gold: #FFD600;
    --christmas-cream: #FFFDE7;
    --christmas-light: #81C784;
    --text-dark: #1A237E;
  }

  * {
    box-sizing: border-box;
    -webkit-tap-highlight-color: transparent;
  }

  body {
    font-family: 'Tangerine', cursive;
    background: linear-gradient(135deg, var(--christmas-red) 0%, var(--christmas-green) 100%);
    overflow: auto;
    margin: 0;
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    color: var(--text-dark);
    padding: 20px;
    touch-action: manipulation;
  }

  .christmas-ball {
    position: fixed;
    width: 25px;
    height: 25px;
    border-radius: 50%;
    background: radial-gradient(circle at 30% 30%, var(--christmas-gold), var(--christmas-red));
    box-shadow: 0 0 15px var(--christmas-gold);
    z-index: 2;
    animation: swing 4s ease-in-out infinite;
  }

  .christmas-light {
    position: fixed;
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background: var(--christmas-gold);
    box-shadow: 0 0 10px currentColor;
    z-index: 2;
    animation: twinkle 2s ease-in-out infinite;
  }

  .snowflake {
    position: fixed;
    top: -10px;
    color: var(--christmas-cream);
    font-size: 1em;
    opacity: 0.8;
    animation: fall linear infinite, shimmer 3s ease-in-out infinite alternate;
    pointer-events: none;
    z-index: 1;
    text-shadow: 0 0 5px var(--christmas-gold);
  }

  @keyframes swing {
    0%, 100% { transform: translateY(0) rotate(-8deg); }
    50% { transform: translateY(-10px) rotate(8deg); }
  }

  @keyframes twinkle {
    0%, 100% { opacity: 0.3; transform: scale(0.8); }
    50% { opacity: 1; transform: scale(1.2); }
  }

  @keyframes fall {
    0% { transform: translateY(0) rotate(0deg); opacity: 1; }
    100% { transform: translateY(100vh) rotate(360deg); opacity: 0.3; }
  }

  @keyframes shimmer {
    from { text-shadow: 0 0 5px var(--christmas-cream); }
    to { text-shadow: 0 0 15px var(--christmas-gold); }
  }

  .card {
    background: linear-gradient(145deg, 
      rgba(255, 253, 231, 0.98) 0%, 
      rgba(129, 199, 132, 0.25) 50%, 
      rgba(255, 253, 231, 0.98) 100%);
    border: 4px solid var(--christmas-gold);
    border-radius: 25px;
    padding: 40px 30px;
    width: 100%;
    max-width: 500px;
    min-height: 500px;
    text-align: center;
    box-shadow: 
      0 25px 50px rgba(229, 57, 53, 0.4),
      0 15px 35px rgba(76, 175, 80, 0.4),
      inset 0 1px 0 rgba(255, 255, 255, 0.8),
      0 0 40px var(--christmas-gold);
    position: relative;
    z-index: 10;
    display: flex;
    flex-direction: column;
    justify-content: center;
    backdrop-filter: blur(5px);
  }

  .card::before {
    content: '';
    position: absolute;
    top: 8px;
    left: 8px;
    right: 8px;
    bottom: 8px;
    border: 2px solid rgba(255, 214, 0, 0.3);
    border-radius: 20px;
    pointer-events: none;
  }

  h1 {
    font-size: 4rem;
    margin-bottom: 30px;
    background: linear-gradient(45deg, var(--christmas-red), var(--christmas-green));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    text-shadow: 3px 3px 6px rgba(255, 253, 231, 0.8);
    letter-spacing: 3px;
  }

  button {
    background: linear-gradient(145deg, var(--christmas-red), var(--christmas-green));
    border: 3px solid var(--christmas-gold);
    color: var(--christmas-cream);
    font-family: 'Tangerine', cursive;
    font-size: 2.8rem;
    padding: 25px 45px;
    border-radius: 60px;
    cursor: pointer;
    box-shadow: 
      0 8px 25px rgba(229, 57, 53, 0.6),
      inset 0 2px 0 rgba(255, 255, 255, 0.5),
      0 0 20px var(--christmas-gold);
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    margin: 18px;
    position: relative;
    overflow: hidden;
    min-height: 80px;
    min-width: 200px;
    display: flex;
    align-items: center;
    justify-content: center;
    touch-action: manipulation;
  }

  button::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, 
      transparent, 
      rgba(255, 255, 255, 0.4), 
      transparent);
    transition: left 0.6s;
  }

  button:active::before {
    left: 100%;
  }

  button:active {
    transform: scale(0.95);
    box-shadow: 
      0 4px 15px rgba(229, 57, 53, 0.5),
      inset 0 2px 0 rgba(255, 255, 255, 0.4);
  }

  button:disabled {
    opacity: 0.6;
    cursor: not-allowed;
    transform: none;
  }

  input {
    width: 90%;
    max-width: 320px;
    padding: 20px;
    border: 3px solid var(--christmas-gold);
    border-radius: 30px;
    font-size: 2.2rem;
    background: rgba(255, 255, 255, 0.98);
    color: var(--text-dark);
    text-align: center;
    font-family: 'Tangerine', cursive;
    box-shadow: 
      inset 0 3px 10px rgba(0, 0, 0, 0.1),
      0 4px 15px rgba(229, 57, 53, 0.3);
    margin: 20px 0;
    transition: all 0.3s ease;
  }

  input::placeholder {
    color: var(--christmas-green);
    opacity: 0.8;
  }

  input:focus {
    outline: none;
    border-color: var(--christmas-red);
    box-shadow: 
      0 0 25px rgba(229, 57, 53, 0.5),
      inset 0 3px 10px rgba(0, 0, 0, 0.1);
    transform: scale(1.02);
  }

  #quote {
    font-size: 3rem;
    color: var(--text-dark);
    text-align: center;
    margin: 40px 0;
    display: none;
    opacity: 0;
    line-height: 1.4;
    text-shadow: 2px 2px 4px rgba(255, 253, 231, 0.9);
  }

  #drawnName {
    font-size: 3.5rem;
    background: linear-gradient(45deg, var(--christmas-red), var(--christmas-green));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    display: none;
    opacity: 0;
    transform: scale(0.3) rotate(-10deg);
    transition: all 3.5s cubic-bezier(0.2, 0.9, 0.3, 1.2);
    margin: 25px 0;
    padding: 15px 25px;
    border-radius: 20px;
    background-color: rgba(255, 253, 231, 0.95);
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
    border: 2px solid var(--christmas-gold);
  }

  #drawnName.reveal {
    opacity: 1;
    transform: scale(1) rotate(0deg);
  }

  #countdown {
    font-size: 4rem;
    color: var(--text-dark);
    margin: 30px 0;
    font-weight: bold;
    text-shadow: 3px 3px 6px rgba(255, 253, 231, 0.9);
  }

  .sparkle {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    overflow: hidden;
    z-index: 100;
  }

  .sparkle span {
    position: absolute;
    background: radial-gradient(circle, var(--christmas-gold), var(--christmas-red), transparent);
    border-radius: 50%;
    animation: shimmerFall 7s linear infinite;
  }

  @keyframes shimmerFall {
    0% { transform: scale(0) translateY(0) rotate(0deg); opacity: 1; }
    100% { transform: scale(2) translateY(100vh) rotate(360deg); opacity: 0; }
  }

  .control-btn {
    position: fixed;
    font-size: 1.3rem;
    color: var(--christmas-cream);
    cursor: pointer;
    opacity: 0.9;
    z-index: 1000;
    background: linear-gradient(145deg, var(--christmas-red), var(--christmas-green));
    padding: 14px 24px;
    border-radius: 30px;
    transition: all 0.3s ease;
    border: 2px solid var(--christmas-gold);
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
    min-width: 160px;
    text-align: center;
    touch-action: manipulation;
    font-family: Arial, sans-serif;
  }

  .control-btn:active {
    transform: scale(0.95);
    opacity: 1;
  }

  #admin { 
    bottom: 25px; 
    right: 25px; 
  }

  #helpBtn {
    bottom: 25px;
    left: 25px;
  }

  #musicControl {
    display: none;
  }

  .panel {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: linear-gradient(145deg, 
      rgba(255, 253, 231, 0.98) 0%, 
      rgba(129, 199, 132, 0.3) 100%);
    border: 4px solid var(--christmas-gold);
    border-radius: 25px;
    padding: 35px;
    width: 90%;
    max-width: 500px;
    z-index: 1000;
    display: none;
    color: var(--text-dark);
    font-family: Arial, sans-serif;
    box-shadow: 0 25px 60px rgba(0, 0, 0, 0.5);
    backdrop-filter: blur(10px);
  }

  .panel h2 {
    text-align: center;
    margin-top: 0;
    font-size: 2rem;
    background: linear-gradient(45deg, var(--christmas-red), var(--christmas-green));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  .panel-actions {
    display: flex;
    flex-direction: column;
    gap: 15px;
    margin-top: 25px;
  }

  .panel-btn {
    background: linear-gradient(145deg, var(--christmas-red), var(--christmas-green));
    color: var(--christmas-cream);
    border: none;
    padding: 18px;
    border-radius: 15px;
    cursor: pointer;
    font-family: Arial, sans-serif;
    font-size: 1.1rem;
    transition: all 0.3s ease;
    border: 2px solid var(--christmas-gold);
    touch-action: manipulation;
  }

  .panel-btn:active {
    transform: scale(0.98);
  }

  .close-btn {
    position: absolute;
    top: 20px;
    right: 25px;
    background: none;
    border: none;
    color: var(--text-dark);
    font-size: 2.5rem;
    cursor: pointer;
    width: 35px;
    height: 35px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: Arial, sans-serif;
  }

  .error-message {
    color: var(--text-dark);
    font-size: 2rem;
    display: none;
    margin-top: 20px;
    background: rgba(255, 253, 231, 0.95);
    padding: 15px;
    border-radius: 15px;
    border: 2px solid var(--christmas-red);
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
  }

  .success-animation {
    animation: bounce 0.6s ease infinite alternate;
  }

  @keyframes bounce {
    from { transform: scale(1); }
    to { transform: scale(1.1); }
  }

  .final-message {
    font-size: 2.5rem;
    color: var(--text-dark);
    margin-top: 30px;
    display: none;
    opacity: 0;
    transition: opacity 3s ease;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
  }

  .final-message.show {
    opacity: 1;
  }

  .pulse {
    animation: pulse 0.6s ease-in-out infinite alternate;
  }

  @keyframes pulse {
    from { transform: scale(1); text-shadow: 0 0 5px var(--christmas-gold); }
    to { transform: scale(1.1); text-shadow: 0 0 20px var(--christmas-gold); }
  }

  .suspense {
    animation: suspense 2s ease-in-out infinite;
  }

  @keyframes suspense {
    0%, 100% { opacity: 0.5; transform: scale(1); }
    50% { opacity: 1; transform: scale(1.1); }
  }

  @media (max-width: 768px) {
    body {
      padding: 15px;
    }
    
    .card {
      padding: 30px 20px;
      min-height: 450px;
      border-radius: 20px;
    }
    
    h1 {
      font-size: 3.2rem;
    }
    
    button {
      font-size: 2.4rem;
      padding: 20px 35px;
      margin: 15px;
      min-height: 70px;
      min-width: 180px;
    }
    
    #quote, #drawnName {
      font-size: 2.6rem;
    }
    
    #countdown {
      font-size: 3.2rem;
    }
    
    input {
      font-size: 2rem;
      padding: 18px;
    }
    
    .control-btn {
      font-size: 1.1rem;
      padding: 12px 20px;
      min-width: 140px;
    }
  }

  @media (max-width: 480px) {
    .card {
      padding: 25px 15px;
      min-height: 400px;
    }
    
    h1 {
      font-size: 2.8rem;
    }
    
    button {
      font-size: 2.2rem;
      padding: 18px 30px;
      margin: 12px;
      min-height: 65px;
      min-width: 160px;
    }
    
    #quote, #drawnName {
      font-size: 2.2rem;
    }
    
    #countdown {
      font-size: 2.8rem;
    }
    
    input {
      font-size: 1.8rem;
      padding: 15px;
    }
    
    .control-btn {
      font-size: 1rem;
      padding: 10px 18px;
      min-width: 130px;
    }
  }

  .input-group {
    margin: 25px 0;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  .no-select {
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
  }
</style>
</head>
<body class="no-select">

<div id="christmasElements"></div>

<audio id="christmasMusic" loop>
  <source src="https://www.chosic.com/wp-content/uploads/2021/12/Jingle-Bells-Choir.mp3" type="audio/mp3">
</audio>

<audio id="beepSound">
  <source src="https://www.soundjay.com/buttons/sounds/button-09.mp3" type="audio/mp3">
</audio>

<audio id="magicSound">
  <source src="https://www.soundjay.com/magic/sounds/magic-wand-1.wav" type="audio/wav">
</audio>

<audio id="completionSound">
  <source src="https://www.soundjay.com/misc/sounds/bell-ringing-04.wav" type="audio/wav">
</audio>

<audio id="revealSound">
  <source src="https://www.soundjay.com/magic/sounds/magic-chime-02.wav" type="audio/wav">
</audio>

<div class="card" id="card">
  <h1>Lebensalm wichtelt</h1>
  <div id="step1">
    <p style="font-size:2.5rem; color: var(--text-dark); margin-bottom: 35px;">Gemeinsam sind wir stark ðŸ’›</p>
    <button id="startBtn">Los geht's</button>
    <button id="helpBtnMain">Wie funktioniert's?</button>
  </div>

  <div id="step2" style="display:none;">
    <p style="font-size:2.2rem; color: var(--text-dark);">Bitte gib deinen Namen ein:</p>
    <div class="input-group">
      <input type="text" id="username" placeholder="Vor- und Nachname">
    </div>
    <div id="nameError" class="error-message">Name nicht gefunden!</div>
    <br>
    <button id="weiterBtn">Weiter</button>
  </div>

  <div id="quote"></div>

  <div id="step3" style="display:none;">
    <button id="drawBtn">Auslosen</button>
    <div id="countdown"></div>
    <div id="drawnName"></div>
    <div id="finalMessage" class="final-message"></div>
  </div>
</div>

<div id="admin" class="control-btn">Admin</div>
<div id="helpBtn" class="control-btn">Hilfe</div>
<div class="sparkle" id="sparkleContainer"></div>

<div class="panel" id="adminPanel">
  <button class="close-btn" id="closeAdmin">Ã—</button>
  <h2>Admin Panel</h2>
  <div class="panel-actions">
    <button class="panel-btn" id="viewPairsBtn">Gezogene Paare anzeigen</button>
    <button class="panel-btn" id="editPairsBtn">Namen ersetzen</button>
    <button class="panel-btn" id="resetAllBtn">ALLE Ziehungen zurÃ¼cksetzen</button>
    <button class="panel-btn" id="exportDataBtn">Daten exportieren</button>
    <button class="panel-btn" id="importDataBtn">Daten importieren</button>
    <button class="panel-btn" id="manageParticipantsBtn">Teilnehmer verwalten</button>
  </div>
</div>

<div class="panel" id="instructions">
  <button class="close-btn" onclick="hideInstructions()">Ã—</button>
  <h2>So funktioniert's:</h2>
  <ol style="font-size: 1.2rem; line-height: 1.8; text-align: left; color: var(--text-dark);">
    <li>Namen eingeben</li>
    <li>Ziehen Button drÃ¼cken</li>
    <li>Spannung genieÃŸen! ðŸŽ„</li>
    <li>Person merken!</li>
    <li>Geheimnis bewahren bis zur Bescherung</li>
  </ol>
  <button class="panel-btn" onclick="hideInstructions()" style="margin-top: 25px;">Verstanden! ðŸŽ…</button>
</div>

<script>
  const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
  
  function createChristmasElements() {
    const container = document.getElementById('christmasElements');
    const ballCount = isMobile ? 12 : 20;
    const lightCount = isMobile ? 15 : 25;
    const snowflakeCount = isMobile ? 60 : 100;

    for (let i = 0; i < ballCount; i++) {
      const ball = document.createElement('div');
      ball.className = 'christmas-ball';
      ball.style.left = Math.random() * 100 + 'vw';
      ball.style.top = Math.random() * 100 + 'vh';
      ball.style.animationDelay = Math.random() * 3 + 's';
      ball.style.width = ball.style.height = (20 + Math.random() * 20) + 'px';
      container.appendChild(ball);
    }

    const colors = ['#FFD600', '#E53935', '#4CAF50', '#81C784', '#FFFDE7'];
    for (let i = 0; i < lightCount; i++) {
      const light = document.createElement('div');
      light.className = 'christmas-light';
      light.style.left = Math.random() * 100 + 'vw';
      light.style.top = Math.random() * 100 + 'vh';
      light.style.animationDelay = Math.random() * 2 + 's';
      light.style.color = colors[Math.floor(Math.random() * colors.length)];
      container.appendChild(light);
    }

    const snowflakes = ['â„', 'â…', 'â†', 'âœ¨', 'ðŸŒŸ', 'â­'];
    for (let i = 0; i < snowflakeCount; i++) {
      const flake = document.createElement('div');
      flake.className = 'snowflake';
      flake.textContent = snowflakes[Math.floor(Math.random() * snowflakes.length)];
      flake.style.left = Math.random() * 100 + 'vw';
      flake.style.animationDuration = (6 + Math.random() * 10) + 's';
      flake.style.fontSize = (0.8 + Math.random() * 1.2) + 'rem';
      flake.style.opacity = 0.4 + Math.random() * 0.6;
      container.appendChild(flake);
    }
  }

  function setupAudio() {
    const music = document.getElementById('christmasMusic');
    
    music.volume = 0.5;
    document.getElementById('beepSound').volume = 0.5;
    document.getElementById('magicSound').volume = 0.7;
    document.getElementById('completionSound').volume = 0.7;
    document.getElementById('revealSound').volume = 0.7;

    let musicStarted = false;
    const startMusic = function() {
      if (!musicStarted) {
        music.play().catch(e => {
          console.log('Music auto-play blocked, waiting for user interaction');
        });
        musicStarted = true;
        document.body.removeEventListener('click', startMusic);
        document.body.removeEventListener('touchstart', startMusic);
      }
    };

    document.body.addEventListener('click', startMusic);
    document.body.addEventListener('touchstart', startMusic, { passive: true });

    setTimeout(() => {
      if (!musicStarted) {
        music.play().catch(() => {
          console.log('Delayed auto-play also blocked');
        });
      }
    }, 1000);
  }

  const startBtn = document.getElementById('startBtn');
  const weiterBtn = document.getElementById('weiterBtn');
  const drawBtn = document.getElementById('drawBtn');
  const usernameInput = document.getElementById('username');
  const step1 = document.getElementById('step1');
  const step2 = document.getElementById('step2');
  const step3 = document.getElementById('step3');
  const quoteEl = document.getElementById('quote');
  const countdownEl = document.getElementById('countdown');
  const drawnName = document.getElementById('drawnName');
  const finalMessage = document.getElementById('finalMessage');
  const sparkleContainer = document.getElementById('sparkleContainer');
  const nameError = document.getElementById('nameError');
  const helpBtnMain = document.getElementById('helpBtnMain');
  const helpBtn = document.getElementById('helpBtn');

  const adminBtn = document.getElementById('admin');
  const adminPanel = document.getElementById('adminPanel');
  const closeAdmin = document.getElementById('closeAdmin');
  const viewPairsBtn = document.getElementById('viewPairsBtn');
  const editPairsBtn = document.getElementById('editPairsBtn');
  const resetAllBtn = document.getElementById('resetAllBtn');
  const exportDataBtn = document.getElementById('exportDataBtn');
  const importDataBtn = document.getElementById('importDataBtn');
  const manageParticipantsBtn = document.getElementById('manageParticipantsBtn');

  const instructions = document.getElementById('instructions');

  // AÅ½URIRANA LISTA SVIH IMENA - SA BETTINA BRUNNER
  let participants = [
    "Ismeta Alukic", "Ibrahim Becirspahic", "Elma Brdanovic", "Ensar Brdanovic", 
    "Martin BÃ¼rger", "Almira Cajtinovic", "Sabine Dam", "Yao Yves Date", 
    "Monika Egger", "Patrick Barbu", "Dominik Garbus", "Ines Genser", 
    "Monika Hartl", "Martina Heibl", "Sabina Kecanovic", "Sanela Softic", 
    "Garbor Kis", "Theresia Koscher", "Corinna Lechner", "Tina Lednik", 
    "Ilija Matic", "Ismeta Mecavica", "Zemina Mehmedovic", "Nadja MÃ¼hlmann", 
    "Almedina Nezic", "Sarah Ogris", "Emina Omahen", "Hana Pecenkovic", 
    "Margareta Pink", "Renate Privasnig", "Ruza Radonic", "Slavica Suhalj", 
    "Monika Tammerl", "Karin Taupe", "Bernhard Tiefenbacher", "Andrea Urban", 
    "Sabrina Wiltschnig", "Enisa Zdionica", "Tanja Kolloros",
    "Bettina Brunner"  // NOVO DODANO!
  ];
  
  // AÅ½URIRANI CITATI SA BETTINA BRUNNER
  const quotes = {
    "Ismeta Alukic": "Humor sollte immer dabei sein, auch bei Problemen! âœ¨",
    "Ibrahim Becirspahic": "Ein Tag ohne LÃ¤cheln ist ein verlorener Tag. ðŸŽ„",
    "Elma Brdanovic": "Der Weg ist das Ziel. ðŸŽ",
    "Ensar Brdanovic": "Wer mit seinen StÃ¤rken arbeitet, wird stÃ¤rker. ðŸŒŸ",
    "Martin BÃ¼rger": "Es ist nicht wenig Zeit, die wir haben, sondern es ist viel Zeit, die wir nicht nutzen. â¤",
    "Almira Cajtinovic": "Verstehen kann man das Leben rÃ¼ckwÃ¤rts; leben muss man es vorwÃ¤rts.",
    "Sabine Dam": "Das Geheimnis des Erfolgs ist die BestÃ¤ndigkeit des Ziels.",
    "Yao Yves Date": "Es ist nicht wenig Zeit, die wir haben, sondern viel Zeit, die wir nicht nutzen.",
    "Monika Egger": "Wenn du genug Selbstvertrauen hast und weiÃŸt, was du willst, wirst du dein Ziel erreichen.",
    "Patrick Barbu": "Wer Erfolg haben will, darf keine Angst haben, Fehler zu machen.",
    "Dominik Garbus": "In Dir muss brennen, was Du in anderen entzÃ¼nden willst.",
    "Ines Genser": "In jeder Schwierigkeit lebt die MÃ¶glichkeit.",
    "Monika Hartl": "Je grÃ¶ÃŸer die Schwierigkeit, die man Ã¼berwand, desto grÃ¶ÃŸer der Sieg.",
    "Martina Heibl": "Zwischen einem der fÃ¼hrt und einem der folgt unterscheidet Innovation.",
    "Sabina Kecanovic": "Es ist wichtig, im Leben auch mal Schritte zu tun, die anderen nicht gefallen.",
    "Sanela Softic": "Wir Frauen mÃ¼ssen an uns selbst glauben, sonst wird es keiner tun.",
    "Garbor Kis": "Sei in guten Zeiten dankbar und in schlechten Zeiten geduldig.",
    "Theresia Koscher": "Du lebst nur ein Mal. Aber wenn du es richtig machst, wird ein Mal auch genug sein.",
    "Corinna Lechner": "Lass dich nicht unterkriegen, sei frech und wild und wunderbar!",
    "Tina Lednik": "Sei die Heldin deines Lebens, nicht das Opfer.",
    "Ilija Matic": "Was am strengsten verboten ist, begehrt der Mensch am meisten",
    "Ismeta Mecavica": "Es ist gut zu wissen, dass man alles machen kann. Man muss nur damit anfangen.",
    "Zemina Mehmedovic": "Hinter jeder starken Frau steht sie selbst.",
    "Nadja MÃ¼hlmann": "Du bist die Heldin deiner Geschichte.",
    "Almedina Nezic": "Glaub an dich â€“ die Welt braucht genau das, was du zu bieten hast.",
    "Sarah Ogris": "Jeder Tag ist eine neue Gelegenheit, deine Geschichte neu zu schreiben.",
    "Emina Omahen": "Ako ti se ne sviÄ‘a put kojim koraÄaÅ¡, poÄni stvarati novi.",
    "Hana Pecenkovic": "Die Grenzen meiner Sprache bedeuten die Grenzen meiner Welt.",
    "Margareta Pink": "Man muss das UnmÃ¶gliche versuchen, um das MÃ¶gliche zu erreichen.",
    "Renate Privasnig": "Selbstbewusst ist das neue SchÃ¶n.",
    "Ruza Radonic": "Å½ena koja ima vlastiti glas definicija je snaÅ¾ne Å¾ene.",
    "Slavica Suhalj": "Hinter jeder starken Frau steht sie selbst.",
    "Monika Tammerl": "Du bist nicht hier, um zu Ã¼berleben, du bist hier, um zu erstrahlen.",
    "Karin Taupe": "Wenn du den Mut hast, zu trÃ¤umen, dann hast du auch den Mut, es zu tun.",
    "Bernhard Tiefenbacher": "Wer kÃ¤mpft, kann verlieren. Wer nicht kÃ¤mpft, hat schon verloren.",
    "Andrea Urban": "Das Leben ist zu kurz fÃ¼r irgendwann.",
    "Sabrina Wiltschnig": "Wenn du fÃ¤llst, stehst du stÃ¤rker wieder auf.",
    "Enisa Zdionica": "Du kannst alles schaffen!",
    "Tanja Kolloros": "Manche Menschen sind ein Geschenk, andere sind eine Lektion.",
    "Bettina Brunner": "Das Leben ist wie eine Schachtel Pralinen - man weiÃŸ nie, was man bekommt, aber es ist immer sÃ¼ÃŸ! ðŸ«"
  };

  function getUsedPairs() {
    return JSON.parse(localStorage.getItem('wichtelPairs') || '{}');
  }

  function savePair(giver, receiver) {
    const pairs = getUsedPairs();
    pairs[giver] = receiver;
    localStorage.setItem('wichtelPairs', JSON.stringify(pairs));
  }

  function addTouchListener(element, event, handler) {
    element.addEventListener(event, handler);
    element.addEventListener('touchstart', function(e) {
      e.preventDefault();
      handler(e);
    }, { passive: false });
  }

  addTouchListener(startBtn, 'click', () => {
    step1.style.display = 'none';
    step2.style.display = 'block';
    setTimeout(() => usernameInput.focus(), 100);
  });

  addTouchListener(weiterBtn, 'click', () => {
    const name = usernameInput.value.trim();
    if (!name) { 
      showError("Bitte gib deinen Namen ein!"); 
      return; 
    }
    
    if (!participants.includes(name)) { 
      showError("Name nicht gefunden!"); 
      return; 
    }

    const pairs = getUsedPairs();
    if (pairs[name]) {
      step2.style.display = 'none';
      showAlreadyDrawn(name, pairs[name]);
      return;
    }

    hideError();
    step2.style.display = 'none';
    showQuote(name);
  });

  function showAlreadyDrawn(name, drawnPerson) {
    quoteEl.textContent = "Du hast bereits gezogen! ðŸŽ…";
    quoteEl.style.display = 'block';
    quoteEl.style.opacity = 1;
    
    setTimeout(() => {
      quoteEl.style.display = 'none';
      step3.style.display = 'block';
      drawnName.textContent = drawnPerson;
      drawnName.style.display = 'block';
      drawnName.classList.add('reveal');
      finalMessage.textContent = "Viel Freude beim Wichteln! ðŸŽâœ¨";
      finalMessage.style.display = 'block';
      finalMessage.classList.add('show');
      drawBtn.style.display = 'none';
    }, 2000);
  }

  function showError(message) {
    nameError.textContent = message;
    nameError.style.display = 'block';
  }

  function hideError() {
    nameError.style.display = 'none';
  }

  function showQuote(name) {
    const quote = quotes[name] || "Frohes Wichteln voller Freude und Magie! âœ¨";
    quoteEl.textContent = '';
    quoteEl.style.display = 'block';
    let words = quote.split(' ');
    let i = 0;
    let interval = setInterval(() => {
      if (i < words.length) {
        quoteEl.textContent += words[i] + ' ';
        quoteEl.style.opacity = 1;
        i++;
      } else {
        clearInterval(interval);
        setTimeout(() => {
          quoteEl.style.display = 'none';
          step3.style.display = 'block';
        }, 2000);
      }
    }, 500);
  }

  addTouchListener(drawBtn, 'click', function() {
    this.disabled = true;
    this.textContent = "Zieht... ðŸŽ„";
    
    countdownEl.textContent = "3";
    countdownEl.classList.add('pulse');
    let count = 3;
    const currentUser = usernameInput.value.trim();
    
    const magicSound = document.getElementById('magicSound');
    magicSound.currentTime = 0;
    magicSound.play();
    
    const timer = setInterval(() => {
      const beepSound = document.getElementById('beepSound');
      beepSound.currentTime = 0;
      beepSound.play();
      count--;
      if (count > 0) {
        countdownEl.textContent = count;
      } else {
        clearInterval(timer);
        countdownEl.textContent = "ðŸŽ…";
        countdownEl.classList.remove('pulse');
        countdownEl.classList.add('suspense');
        
        const pairs = getUsedPairs();
        const others = participants.filter(p => p !== currentUser && !Object.values(pairs).includes(p));
        
        if (others.length === 0) {
          drawnName.textContent = "Keine Namen mehr! ðŸŽ";
          drawnName.style.display = 'block';
          drawnName.classList.add('reveal');
          magicSound.pause();
        } else {
          const chosen = others[Math.floor(Math.random() * others.length)];
          
          setTimeout(() => {
            magicSound.pause();
            const revealSound = document.getElementById('revealSound');
            revealSound.currentTime = 0;
            revealSound.play();
            countdownEl.classList.remove('suspense');
            countdownEl.textContent = "";
            
            drawnName.textContent = chosen;
            drawnName.style.display = 'block';
            
            setTimeout(() => {
              drawnName.classList.add('reveal');
              
              setTimeout(() => {
                const completionSound = document.getElementById('completionSound');
                completionSound.currentTime = 0;
                completionSound.play();
                sparkleEffect();
                savePair(currentUser, chosen);
                
                finalMessage.textContent = "Viel Freude beim Wichteln! ðŸŽâœ¨";
                finalMessage.style.display = 'block';
                setTimeout(() => {
                  finalMessage.classList.add('show');
                }, 100);
                
                this.style.display = 'none';
              }, 3000);
            }, 1000);
          }, 3000);
        }
      }
    }, 1000);
  });

  function sparkleEffect() {
    const count = isMobile ? 120 : 180;
    for (let i = 0; i < count; i++) {
      const span = document.createElement('span');
      span.style.left = Math.random() * 100 + '%';
      span.style.top = Math.random() * 100 + '%';
      span.style.width = span.style.height = Math.random() * 20 + 8 + 'px';
      span.style.animationDuration = (5 + Math.random() * 4) + 's';
      sparkleContainer.appendChild(span);
      setTimeout(() => span.remove(), 7000);
    }
  }

  addTouchListener(adminBtn, 'click', () => {
    const password = prompt("Admin Passwort eingeben:");
    if (password === "geheim") {
      adminPanel.style.display = 'block';
    } else {
      alert("Falsches Passwort!");
    }
  });

  addTouchListener(closeAdmin, 'click', () => {
    adminPanel.style.display = 'none';
  });

  addTouchListener(viewPairsBtn, 'click', () => {
    const pairs = getUsedPairs();
    let result = "Gezogene Paare:\n\n";
    
    if (Object.keys(pairs).length === 0) {
      result = "Noch keine Ziehungen!";
    } else {
      Object.entries(pairs).forEach(([giver, receiver]) => {
        result += `${giver} â†’ ${receiver}\n`;
      });
    }
    
    alert(result);
  });

  addTouchListener(editPairsBtn, 'click', () => {
    const pairs = getUsedPairs();
    if (Object.keys(pairs).length === 0) {
      alert("Noch keine Ziehungen zum Bearbeiten!");
      return;
    }
    
    let pairList = "Aktuelle Paare:\n\n";
    Object.entries(pairs).forEach(([giver, receiver]) => {
      pairList += `${giver} â†’ ${receiver}\n`;
    });
    
    const editChoice = prompt(pairList + "\nWelches Paar mÃ¶chten Sie Ã¤ndern? Geben Sie den Namen des Gebers ein:");
    if (editChoice && pairs[editChoice]) {
      const newReceiver = prompt(`Aktuell: ${editChoice} â†’ ${pairs[editChoice]}\nNeuer EmpfÃ¤nger:`, pairs[editChoice]);
      if (newReceiver && participants.includes(newReceiver)) {
        pairs[editChoice] = newReceiver;
        localStorage.setItem('wichtelPairs', JSON.stringify(pairs));
        alert("Paar erfolgreich geÃ¤ndert!");
      } else if (newReceiver) {
        alert("Neuer EmpfÃ¤nger nicht in der Teilnehmerliste!");
      }
    } else if (editChoice) {
      alert("Geber nicht gefunden!");
    }
  });

  addTouchListener(resetAllBtn, 'click', () => {
    if (confirm("Wirklich ALLE Ziehungen zurÃ¼cksetzen? Diese Aktion kann nicht rÃ¼ckgÃ¤ngig gemacht werden!")) {
      localStorage.removeItem('wichtelPairs');
      alert("Alle Ziehungen wurden zurÃ¼ckgesetzt!");
      adminPanel.style.display = 'none';
      location.reload();
    }
  });

  addTouchListener(exportDataBtn, 'click', () => {
    const data = localStorage.getItem('wichtelPairs');
    const blob = new Blob([data], {type: 'application/json'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'wichtel-backup.json';
    a.click();
    alert("Daten wurden exportiert!");
  });

  addTouchListener(importDataBtn, 'click', () => {
    const input = document.createElement('input');
    input.type = 'file';
    input.accept = '.json';
    input.onchange = e => {
      const file = e.target.files[0];
      const reader = new FileReader();
      reader.onload = function(event) {
        try {
          const data = JSON.parse(event.target.result);
          localStorage.setItem('wichtelPairs', JSON.stringify(data));
          alert("Daten wurden importiert!");
          adminPanel.style.display = 'none';
          location.reload();
        } catch (err) {
          alert("Fehler beim Importieren: " + err.message);
        }
      };
      reader.readAsText(file);
    };
    input.click();
  });

  addTouchListener(manageParticipantsBtn, 'click', () => {
    const newList = prompt("Aktuelle Teilnehmer:\n" + participants.join("\n") + 
                          "\n\nNeue Liste eingeben (ein Name pro Zeile):", participants.join("\n"));
    
    if (newList) {
      participants = newList.split('\n').map(name => name.trim()).filter(name => name);
      alert("Teilnehmerliste aktualisiert!");
    }
  });

  addTouchListener(helpBtnMain, 'click', showInstructions);
  addTouchListener(helpBtn, 'click', showInstructions);

  function showInstructions() {
    instructions.style.display = 'block';
  }

  function hideInstructions() {
    instructions.style.display = 'none';
  }

  createChristmasElements();
  setupAudio();

  if (isMobile) {
    document.body.classList.add('mobile-device');
  }

  usernameInput.addEventListener('focus', function() {
    setTimeout(() => {
      window.scrollTo({
        top: this.getBoundingClientRect().top + window.pageYOffset - 100,
        behavior: 'smooth'
      });
    }, 300);
  });
</script>
</body>
</html>
